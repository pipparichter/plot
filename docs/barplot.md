# The BarPlot class

Barplots are created by sorting the cells into bins based on their expression of a certain gene,
and then normalixing the cell count in each bin based on the total `ncells` in a sample.

## Initialization

Barplots can be created using the `BarPlot` class, which takes the following arguments upon initialization. Note that
all argumentes are keyword arguments, with the exception of `pop`.

* `pop` **dict** The PopAlign object.
* `type_` **str** The type of BarPlot to be created. One of `'g_s'`.
* `is_subplot` **bool** Whether or not the BarPlot is a subplot. `False` by default. This argument should not be changed 
directly; it is set as `True` when the inititalizer is called within the [Grid class](./grid.md) inititalizer.
* `nbins` **int** The number of bins into which the gene expression data will be sorted. `25` by default.

Each type of BarPlot takes different arguments as keyword arguments upon initialization. These arguments, as well as descriptions 
of each BarPlot type, are given below.

### Type `g_s` 

BarPlots of type `g_s` are distributions of gene expression for a particular gene `g`, in a particular sample `s`, across 
a single cell type. Expression data is stored in the PopAlign object as log-scaled counts of mRNA transcripts; there is one 
such datapoint per individual cell per gene. 

In addition to the basic BarPlot arguments, listed above, `g_s` BarPlots take the following parameters:

* `gene` **string** The gene for which to create the expression distribution. It must be a valid gene name in 
`pop['filtered_genes']`.
* `celltype` **string** The cell type for which to create the plot. One of `'Myeloid'`, `'B-cell'`, `'T cell'`.
* `sample` **string** The name of a sample in `pop['samples'].keys()`.
* `merge_samples` **bool** Whether or not to merge replicate samples, e.g. `'ALL CYTO'` and `'ALL CYTO_rep'`. This is `True`
by default. 

## Usage

Barplots can be generated using the code below. Colors can be specified using a two-tuple, where the tuple
elements are strings representing valid `matplotlib` [colors](https://matplotlib.org/2.0.2/api/colors_api.html).

```python
from plotpop import barplot # Import the barplot module.

params = {'celltype':'T cell', 'gene':'CD3D', sample:'ALL CYTO', 'merge_samples':True}
bar = barplot.BarPlot(pop, type_='g_s', **params)
bar.plot() # The default colors are salmon and turquoise

params['merge_samples'] = False # Turn off sample merging.
another_bar = barplot.BarPlot(pop, type_='g_s', **params)
another_bar.plot(color=('yellow', 'magenta')) # Plot the new BarPlot with colors other than the default.
```

The code above produces the following graphs: 

<img src="https://github.com/pipparichter/plotpop/blob/master/docs/example_barplot.png" width="300" height="300">


After figures have been generated by `plot()` and stored in the `figure` attribute, the barplots can be saved. If 
no filenames are specified, the default filenames `barplot.png` and `barplot_grid.png` are used. Saving multiple barplots
without specifying a different filename will result in them being overwritten.

```python
bar.save(filename='example_barplot.png')
another_bar.save(filename='another_example_barplot.png')
```

